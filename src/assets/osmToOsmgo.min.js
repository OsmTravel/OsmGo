var osmToOsmgo=function(t){"use strict";function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||r(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(t,e){return t(e={exports:{}},e.exports),e.exports}var s=a((function(t,e){const r=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",n="["+r+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",o=new RegExp("^"+n+"$");e.isExist=function(t){return void 0!==t},e.isEmptyObject=function(t){return 0===Object.keys(t).length},e.merge=function(t,e,r){if(e){const n=Object.keys(e),o=n.length;for(let i=0;i<o;i++)t[n[i]]="strict"===r?[e[n[i]]]:e[n[i]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.buildOptions=function(t,e,r){let n={};if(!t)return e;for(let o=0;o<r.length;o++)void 0!==t[r[o]]?n[r[o]]=t[r[o]]:n[r[o]]=e[r[o]];return n},e.isTagNameInArrayMode=function(t,e,r){return!1!==e&&(e instanceof RegExp?e.test(t):"function"==typeof e?!!e(t,r):"strict"===e)},e.isName=function(t){const e=o.exec(t);return!(null==e)},e.getAllMatches=function(t,e){const r=[];let n=e.exec(t);for(;n;){const o=[];o.startIndex=e.lastIndex-n[0].length;const i=n.length;for(let t=0;t<i;t++)o.push(n[t]);r.push(o),n=e.exec(t)}return r},e.nameRegexp=n}));s.isExist,s.isEmptyObject,s.merge,s.getValue,s.buildOptions,s.isTagNameInArrayMode,s.isName,s.getAllMatches,s.nameRegexp;const u=function(t,e,r){const n={};if(!e.alwaysCreateTextNode&&(!t.child||s.isEmptyObject(t.child))&&(!t.attrsMap||s.isEmptyObject(t.attrsMap)))return s.isExist(t.val)?t.val:"";if(s.isExist(t.val)&&("string"!=typeof t.val||""!==t.val&&t.val!==e.cdataPositionChar)){const o=s.isTagNameInArrayMode(t.tagname,e.arrayMode,r);n[e.textNodeName]=o?[t.val]:t.val}s.merge(n,t.attrsMap,e.arrayMode);const o=Object.keys(t.child);for(let i=0;i<o.length;i++){const a=o[i];if(t.child[a]&&t.child[a].length>1){n[a]=[];for(let r in t.child[a])t.child[a].hasOwnProperty(r)&&n[a].push(u(t.child[a][r],e,a))}else{const o=u(t.child[a][0],e,a),i=!0===e.arrayMode&&"object"==typeof o||s.isTagNameInArrayMode(a,e.arrayMode,r);n[a]=i?[o]:o}}return n};var l={convertToJson:u},c=function(t,e,r){this.tagname=t,this.parent=e,this.child={},this.attrsMap={},this.val=r,this.addChild=function(t){Array.isArray(this.child[t.tagname])?this.child[t.tagname].push(t):this.child[t.tagname]=[t]}};const f=/^[-+]?0x[a-fA-F0-9]+$/,p=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const h={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};var g=function(t,e={}){if(e=Object.assign({},h,e),!t||"string"!=typeof t)return t;let r=t.trim();if(void 0!==e.skipLike&&e.skipLike.test(r))return t;if(e.hex&&f.test(r))return Number.parseInt(r,16);{const n=p.exec(r);if(n){const o=n[1],i=n[2];let a=function(t){if(t&&-1!==t.indexOf("."))return"."===(t=t.replace(/0+$/,""))?t="0":"."===t[0]?t="0"+t:"."===t[t.length-1]&&(t=t.substr(0,t.length-1)),t;return t}(n[3]);const s=n[4]||n[6];if(!e.leadingZeros&&i.length>0&&o&&"."!==r[2])return t;if(!e.leadingZeros&&i.length>0&&!o&&"."!==r[1])return t;{const n=Number(r),u=""+n;return-1!==u.search(/[eE]/)||s?e.eNotation?n:t:-1!==r.indexOf(".")?"0"===u&&""===a||u===a||o&&u==="-"+a?n:t:i?a===u||o+a===u?n:t:r===u||r===o+u?n:t}}return t}};const d=s.buildOptions;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,s.nameRegexp),!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const y={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",numParseOptions:{hex:!0,leadingZeros:!0},tagValueProcessor:function(t,e){return t},attrValueProcessor:function(t,e){return t},stopNodes:[],alwaysCreateTextNode:!1};var v=y;const m=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","numParseOptions","stopNodes","alwaysCreateTextNode"];var b=m;function w(t,e,r){return e&&(r.trimValues&&(e=e.trim()),e=A(e=r.tagValueProcessor(e,t),r.parseNodeValue,r.numParseOptions)),e}function j(t,e){if(e.ignoreNameSpace){const e=t.split(":"),r="/"===t.charAt(0)?"/":"";if("xmlns"===e[0])return"";2===e.length&&(t=r+e[1])}return t}function A(t,e,r){if(e&&"string"==typeof t){const e=t.trim();return"true"===e||"false"!==e&&g(t,r)}return s.isExist(t)?t:""}const E=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function x(t,e){if(!e.ignoreAttributes&&"string"==typeof t){t=t.replace(/\r?\n/g," ");const r=s.getAllMatches(t,E),n=r.length,o={};for(let t=0;t<n;t++){const n=j(r[t][1],e);n.length&&(void 0!==r[t][4]?(e.trimValues&&(r[t][4]=r[t][4].trim()),r[t][4]=e.attrValueProcessor(r[t][4],n),o[e.attributeNamePrefix+n]=A(r[t][4],e.parseAttributeValue,e.numParseOptions)):e.allowBooleanAttributes&&(o[e.attributeNamePrefix+n]=!0))}if(!Object.keys(o).length)return;if(e.attrNodeName){const t={};return t[e.attrNodeName]=o,t}return o}}function N(t,e){let r,n="";for(let o=e;o<t.length;o++){let e=t[o];if(r)e===r&&(r="");else if('"'===e||"'"===e)r=e;else{if(">"===e)return{data:n,index:o};"\t"===e&&(e=" ")}n+=e}}function O(t,e,r,n){const o=t.indexOf(e,r);if(-1===o)throw new Error(n);return o+e.length-1}var _={defaultOptions:v,props:b,getTraversalObj:function(t,e){t=t.replace(/\r\n?/g,"\n"),e=d(e,y,m);const r=new c("!xml");let n=r,o="";for(let r=0;r<t.length;r++){if("<"===t[r])if("/"===t[r+1]){const i=O(t,">",r,"Closing Tag is not closed.");let a=t.substring(r+2,i).trim();if(e.ignoreNameSpace){const t=a.indexOf(":");-1!==t&&(a=a.substr(t+1))}n&&(n.val?n.val=s.getValue(n.val)+""+w(a,o,e):n.val=w(a,o,e)),e.stopNodes.length&&e.stopNodes.includes(n.tagname)&&(n.child=[],null==n.attrsMap&&(n.attrsMap={}),n.val=t.substr(n.startIndex+1,r-n.startIndex-1)),n=n.parent,o="",r=i}else if("?"===t[r+1])r=O(t,"?>",r,"Pi Tag is not closed.");else if("!--"===t.substr(r+1,3))r=O(t,"--\x3e",r,"Comment is not closed.");else if("!D"===t.substr(r+1,2)){const e=O(t,">",r,"DOCTYPE is not closed.");r=t.substring(r,e).indexOf("[")>=0?t.indexOf("]>",r)+1:e}else if("!["===t.substr(r+1,2)){const i=O(t,"]]>",r,"CDATA is not closed.")-2,a=t.substring(r+9,i);if(o&&(n.val=s.getValue(n.val)+""+w(n.tagname,o,e),o=""),e.cdataTagName){const t=new c(e.cdataTagName,n,a);n.addChild(t),n.val=s.getValue(n.val)+e.cdataPositionChar,a&&(t.val=a)}else n.val=(n.val||"")+(a||"");r=i+2}else{const i=N(t,r+1);let a=i.data;const u=i.index,l=a.indexOf(" ");let f=a,p=!0;if(-1!==l&&(f=a.substr(0,l).replace(/\s\s*$/,""),a=a.substr(l+1)),e.ignoreNameSpace){const t=f.indexOf(":");-1!==t&&(f=f.substr(t+1),p=f!==i.data.substr(t+1))}if(n&&o&&"!xml"!==n.tagname&&(n.val=s.getValue(n.val)+""+w(n.tagname,o,e)),a.length>0&&a.lastIndexOf("/")===a.length-1){"/"===f[f.length-1]?(f=f.substr(0,f.length-1),a=f):a=a.substr(0,a.length-1);const t=new c(f,n,"");f!==a&&(t.attrsMap=x(a,e)),n.addChild(t)}else{const t=new c(f,n);e.stopNodes.length&&e.stopNodes.includes(t.tagname)&&(t.startIndex=u),f!==a&&p&&(t.attrsMap=x(a,e)),n.addChild(t),n=t}o="",r=u}else o+=t[r]}return r}};const P={allowBooleanAttributes:!1},S=["allowBooleanAttributes"];function C(t,e){const r=e;for(;e<t.length;e++)if("?"!=t[e]&&" "!=t[e]);else{const n=t.substr(r,e-r);if(e>5&&"xml"===n)return V("InvalidXml","XML declaration allowed only at the start of the document.",L(t,e));if("?"==t[e]&&">"==t[e+1]){e++;break}}return e}function T(t,e){if(t.length>e+5&&"-"===t[e+1]&&"-"===t[e+2]){for(e+=3;e<t.length;e++)if("-"===t[e]&&"-"===t[e+1]&&">"===t[e+2]){e+=2;break}}else if(t.length>e+8&&"D"===t[e+1]&&"O"===t[e+2]&&"C"===t[e+3]&&"T"===t[e+4]&&"Y"===t[e+5]&&"P"===t[e+6]&&"E"===t[e+7]){let r=1;for(e+=8;e<t.length;e++)if("<"===t[e])r++;else if(">"===t[e]&&(r--,0===r))break}else if(t.length>e+9&&"["===t[e+1]&&"C"===t[e+2]&&"D"===t[e+3]&&"A"===t[e+4]&&"T"===t[e+5]&&"A"===t[e+6]&&"["===t[e+7])for(e+=8;e<t.length;e++)if("]"===t[e]&&"]"===t[e+1]&&">"===t[e+2]){e+=2;break}return e}function k(t,e){let r="",n="",o=!1;for(;e<t.length;e++){if('"'===t[e]||"'"===t[e])""===n?n=t[e]:n!==t[e]||(n="");else if(">"===t[e]&&""===n){o=!0;break}r+=t[e]}return""===n&&{value:r,index:e,tagClosed:o}}const F=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function M(t,e){const r=s.getAllMatches(t,F),n={};for(let t=0;t<r.length;t++){if(0===r[t][1].length)return V("InvalidAttr","Attribute '"+r[t][2]+"' has no space in starting.",B(r[t]));if(void 0===r[t][3]&&!e.allowBooleanAttributes)return V("InvalidAttr","boolean attribute '"+r[t][2]+"' is not allowed.",B(r[t]));const o=r[t][2];if(!D(o))return V("InvalidAttr","Attribute '"+o+"' is an invalid name.",B(r[t]));if(n.hasOwnProperty(o))return V("InvalidAttr","Attribute '"+o+"' is repeated.",B(r[t]));n[o]=1}return!0}function I(t,e){if(";"===t[++e])return-1;if("#"===t[e])return function(t,e){let r=/\d/;for("x"===t[e]&&(e++,r=/[\da-fA-F]/);e<t.length;e++){if(";"===t[e])return e;if(!t[e].match(r))break}return-1}(t,++e);let r=0;for(;e<t.length;e++,r++)if(!(t[e].match(/\w/)&&r<20)){if(";"===t[e])break;return-1}return e}function V(t,e,r){return{err:{code:t,msg:e,line:r.line||r,col:r.col}}}function D(t){return s.isName(t)}function L(t,e){const r=t.substring(0,e).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function B(t){return t.startIndex+t[1].length}var q=function(t,e){e=s.buildOptions(e,P,S);const r=[];let n=!1,o=!1;"\ufeff"===t[0]&&(t=t.substr(1));for(let a=0;a<t.length;a++)if("<"===t[a]&&"?"===t[a+1]){if(a+=2,a=C(t,a),a.err)return a}else{if("<"!==t[a]){if(" "===t[a]||"\t"===t[a]||"\n"===t[a]||"\r"===t[a])continue;return V("InvalidChar","char '"+t[a]+"' is not expected.",L(t,a))}{let u=a;if(a++,"!"===t[a]){a=T(t,a);continue}{let l=!1;"/"===t[a]&&(l=!0,a++);let c="";for(;a<t.length&&">"!==t[a]&&" "!==t[a]&&"\t"!==t[a]&&"\n"!==t[a]&&"\r"!==t[a];a++)c+=t[a];if(c=c.trim(),"/"===c[c.length-1]&&(c=c.substring(0,c.length-1),a--),i=c,!s.isName(i)){let e;return e=0===c.trim().length?"Invalid space after '<'.":"Tag '"+c+"' is an invalid name.",V("InvalidTag",e,L(t,a))}const f=k(t,a);if(!1===f)return V("InvalidAttr","Attributes for '"+c+"' have open quote.",L(t,a));let p=f.value;if(a=f.index,"/"===p[p.length-1]){const r=a-p.length;p=p.substring(0,p.length-1);const o=M(p,e);if(!0!==o)return V(o.err.code,o.err.msg,L(t,r+o.err.line));n=!0}else if(l){if(!f.tagClosed)return V("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",L(t,a));if(p.trim().length>0)return V("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",L(t,u));{const e=r.pop();if(c!==e.tagName){let r=L(t,e.tagStartPos);return V("InvalidTag","Expected closing tag '"+e.tagName+"' (opened in line "+r.line+", col "+r.col+") instead of closing tag '"+c+"'.",L(t,u))}0==r.length&&(o=!0)}}else{const i=M(p,e);if(!0!==i)return V(i.err.code,i.err.msg,L(t,a-p.length+i.err.line));if(!0===o)return V("InvalidXml","Multiple possible root nodes found.",L(t,a));r.push({tagName:c,tagStartPos:u}),n=!0}for(a++;a<t.length;a++)if("<"===t[a]){if("!"===t[a+1]){a++,a=T(t,a);continue}if("?"!==t[a+1])break;if(a=C(t,++a),a.err)return a}else if("&"===t[a]){const e=I(t,a);if(-1==e)return V("InvalidChar","char '&' is not expected.",L(t,a));a=e}"<"===t[a]&&a--}}}var i;return n?1==r.length?V("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",L(t,r[0].tagStartPos)):!(r.length>0)||V("InvalidXml","Invalid '"+JSON.stringify(r.map((t=>t.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):V("InvalidXml","Start tag expected.",1)};const R=function(t){return String.fromCharCode(t)},z={nilChar:R(176),missingChar:R(201),nilPremitive:R(175),missingPremitive:R(200),emptyChar:R(178),emptyValue:R(177),boundryChar:R(179),objStart:R(198),arrStart:R(204),arrayEnd:R(185)},G=[z.nilChar,z.nilPremitive,z.missingChar,z.missingPremitive,z.boundryChar,z.emptyChar,z.emptyValue,z.arrayEnd,z.objStart,z.arrStart],U=function(t,e,r){if("string"==typeof e)return t&&t[0]&&void 0!==t[0].val?J(t[0].val):J(t);{const o=void 0===(n=t)?z.missingChar:null===n?z.nilChar:!(n.child&&0===Object.keys(n.child).length&&(!n.attrsMap||0===Object.keys(n.attrsMap).length))||z.emptyChar;if(!0===o){let n="";if(Array.isArray(e)){n+=z.arrStart;const o=e[0],i=t.length;if("string"==typeof o)for(let e=0;e<i;e++){const r=J(t[e].val);n=$(n,r)}else for(let e=0;e<i;e++){const i=U(t[e],o,r);n=$(n,i)}n+=z.arrayEnd}else{n+=z.objStart;const o=Object.keys(e);Array.isArray(t)&&(t=t[0]);for(let i in o){const a=o[i];let s;s=!r.ignoreAttributes&&t.attrsMap&&t.attrsMap[a]?U(t.attrsMap[a],e[a],r):a===r.textNodeName?U(t.val,e[a],r):U(t.child[a],e[a],r),n=$(n,s)}}return n}return o}var n},J=function(t){switch(t){case void 0:return z.missingPremitive;case null:return z.nilPremitive;case"":return z.emptyValue;default:return t}},$=function(t,e){return W(e[0])||W(t[t.length-1])||(t+=z.boundryChar),t+e},W=function(t){return-1!==G.indexOf(t)};const Z=s.buildOptions;var X={convert2nimn:function(t,e,r){return r=Z(r,_.defaultOptions,_.props),U(t,e,r)}};const K=s.buildOptions,Y=function(t,e,r){let n="{";const o=Object.keys(t.child);for(let r=0;r<o.length;r++){const i=o[r];if(t.child[i]&&t.child[i].length>1){n+='"'+i+'" : [ ';for(let r in t.child[i])n+=Y(t.child[i][r],e)+" , ";n=n.substr(0,n.length-1)+" ] "}else n+='"'+i+'" : '+Y(t.child[i][0],e)+" ,"}return s.merge(n,t.attrsMap),s.isEmptyObject(n)?s.isExist(t.val)?t.val:"":(s.isExist(t.val)&&("string"!=typeof t.val||""!==t.val&&t.val!==e.cdataPositionChar)&&(n+='"'+e.textNodeName+'" : '+(!0!==(i=t.val)&&!1!==i&&isNaN(i)?'"'+i+'"':i)),","===n[n.length-1]&&(n=n.substr(0,n.length-2)),n+"}");var i};var H={convertToJsonString:function(t,e){return(e=K(e,_.defaultOptions,_.props)).indentBy=e.indentBy||"",Y(t,e)}};const Q=s.buildOptions,tt={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(t){return t},attrValueProcessor:function(t){return t}},et=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor","rootNodeName"];function rt(t){this.options=Q(t,tt,et),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=ft),this.options.cdataTagName?this.isCDATA=pt:this.isCDATA=function(){return!1},this.replaceCDATAstr=ot,this.replaceCDATAarr=it,this.processTextOrObjNode=nt,this.options.format?(this.indentate=ct,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=lt,this.buildObjNode=st):(this.buildTextNode=ut,this.buildObjNode=at),this.buildTextValNode=ut,this.buildObjectNode=at}function nt(t,e,r){const n=this.j2x(t,r+1);return void 0!==t[this.options.textNodeName]&&1===Object.keys(t).length?this.buildTextNode(n.val,e,n.attrStr,r):this.buildObjNode(n.val,e,n.attrStr,r)}function ot(t,e){return t=this.options.tagValueProcessor(""+t),""===this.options.cdataPositionChar||""===t?t+"<![CDATA["+e+"]]"+this.tagEndChar:t.replace(this.options.cdataPositionChar,"<![CDATA["+e+"]]"+this.tagEndChar)}function it(t,e){if(t=this.options.tagValueProcessor(""+t),""===this.options.cdataPositionChar||""===t)return t+"<![CDATA["+e.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let r in e)t=t.replace(this.options.cdataPositionChar,"<![CDATA["+e[r]+"]]>");return t+this.newLine}function at(t,e,r,n){return r&&-1===t.indexOf("<")?this.indentate(n)+"<"+e+r+">"+t+"</"+e+this.tagEndChar:this.indentate(n)+"<"+e+r+this.tagEndChar+t+this.indentate(n)+"</"+e+this.tagEndChar}function st(t,e,r,n){return""!==t?this.buildObjectNode(t,e,r,n):this.indentate(n)+"<"+e+r+"/"+this.tagEndChar}function ut(t,e,r,n){return this.indentate(n)+"<"+e+r+">"+this.options.tagValueProcessor(t)+"</"+e+this.tagEndChar}function lt(t,e,r,n){return""!==t?this.buildTextValNode(t,e,r,n):this.indentate(n)+"<"+e+r+"/"+this.tagEndChar}function ct(t){return this.options.indentBy.repeat(t)}function ft(t){return!!t.startsWith(this.options.attributeNamePrefix)&&t.substr(this.attrPrefixLen)}function pt(t){return t===this.options.cdataTagName}rt.prototype.parse=function(t){return Array.isArray(t)&&this.options.rootNodeName&&this.options.rootNodeName.length>1&&(t={[this.options.rootNodeName]:t}),this.j2x(t,0).val},rt.prototype.j2x=function(t,e){let r="",n="";for(let o in t)if(void 0===t[o]);else if(null===t[o])n+=this.indentate(e)+"<"+o+"/"+this.tagEndChar;else if(t[o]instanceof Date)n+=this.buildTextNode(t[o],o,"",e);else if("object"!=typeof t[o]){const i=this.isAttribute(o);i?r+=" "+i+'="'+this.options.attrValueProcessor(""+t[o])+'"':this.isCDATA(o)?t[this.options.textNodeName]?n+=this.replaceCDATAstr(t[this.options.textNodeName],t[o]):n+=this.replaceCDATAstr("",t[o]):o===this.options.textNodeName?t[this.options.cdataTagName]||(n+=this.options.tagValueProcessor(""+t[o])):n+=this.buildTextNode(t[o],o,"",e)}else if(Array.isArray(t[o]))if(this.isCDATA(o))n+=this.indentate(e),t[this.options.textNodeName]?n+=this.replaceCDATAarr(t[this.options.textNodeName],t[o]):n+=this.replaceCDATAarr("",t[o]);else{const r=t[o].length;for(let i=0;i<r;i++){const r=t[o][i];void 0===r||(n+=null===r?this.indentate(e)+"<"+o+"/"+this.tagEndChar:"object"==typeof r?this.processTextOrObjNode(r,o,e):this.buildTextNode(r,o,"",e))}}else if(this.options.attrNodeName&&o===this.options.attrNodeName){const e=Object.keys(t[o]),n=e.length;for(let i=0;i<n;i++)r+=" "+e[i]+'="'+this.options.attrValueProcessor(""+t[o][e[i]])+'"'}else n+=this.processTextOrObjNode(t[o],o,e);return{attrStr:r,val:n}};var ht=rt,gt=a((function(t,e){const r=_,n=s.buildOptions;e.parse=function(t,e={},o){if(o){!0===o&&(o={});const e=q(t,o);if(!0!==e)throw Error(e.err.msg)}e.parseTrueNumberOnly&&!1!==e.parseNodeValue&&!e.numParseOptions&&(e.numParseOptions={leadingZeros:!1});let i=n(e,r.defaultOptions,r.props);const a=_.getTraversalObj(t,i);return l.convertToJson(a,i)},e.convertTonimn=X.convert2nimn,e.getTraversalObj=_.getTraversalObj,e.convertToJson=l.convertToJson,e.convertToJsonString=H.convertToJsonString,e.validate=q,e.j2xParser=ht,e.parseToNimn=function(t,r,n){return e.convertTonimn(e.getTraversalObj(t,n),r,n)}}));function dt(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!yt(t[0])||!yt(t[1]))throw new Error("coordinates must contain numbers");return function(t,e,r){if(!vt(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&mt(n),o&&bt(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}({type:"Point",coordinates:t},e,r)}function yt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function vt(t){return!!t&&t.constructor===Object}function mt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!yt(t))throw new Error("bbox must only contain numbers")}))}function bt(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function wt(t,e,r){if(null!==t)for(var n,o,i,a,s,u,l,c,f=0,p=0,h=t.type,g="FeatureCollection"===h,d="Feature"===h,y=g?t.features.length:1,v=0;v<y;v++){s=(c=!!(l=g?t.features[v].geometry:d?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<s;m++){var b=0,w=0;if(null!==(a=c?l.geometries[m]:l)){u=a.coordinates;var j=a.type;switch(f=!r||"Polygon"!==j&&"MultiPolygon"!==j?0:1,j){case null:break;case"Point":if(!1===e(u,p,v,b,w))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],p,v,b,w))return!1;p++,"MultiPoint"===j&&b++}"LineString"===j&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-f;o++){if(!1===e(u[n][o],p,v,b,w))return!1;p++}"MultiLineString"===j&&b++,"Polygon"===j&&w++}"Polygon"===j&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for("MultiPolygon"===j&&(w=0),o=0;o<u[n].length;o++){for(i=0;i<u[n][o].length-f;i++){if(!1===e(u[n][o][i],p,v,b,w))return!1;p++}w++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===wt(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function jt(t){var e=[];return"FeatureCollection"===t.type?function(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}(t,(function(t){wt(t,(function(r){e.push(dt(r,t.properties))}))})):wt(t,(function(r){e.push(dt(r,t.properties))})),function(t,e){if(!vt(e=e||{}))throw new Error("options is invalid");var r=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&mt(r),n&&bt(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=t,o}(e)}function At(t,e,r){if(null!==t)for(var n,o,i,a,s,u,l,c,f=0,p=0,h=t.type,g="FeatureCollection"===h,d="Feature"===h,y=g?t.features.length:1,v=0;v<y;v++){s=(c=!!(l=g?t.features[v].geometry:d?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<s;m++){var b=0,w=0;if(null!==(a=c?l.geometries[m]:l)){u=a.coordinates;var j=a.type;switch(f=!r||"Polygon"!==j&&"MultiPolygon"!==j?0:1,j){case null:break;case"Point":if(!1===e(u,p,v,b,w))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],p,v,b,w))return!1;p++,"MultiPoint"===j&&b++}"LineString"===j&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-f;o++){if(!1===e(u[n][o],p,v,b,w))return!1;p++}"MultiLineString"===j&&b++,"Polygon"===j&&w++}"Polygon"===j&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for("MultiPolygon"===j&&(w=0),o=0;o<u[n].length;o++){for(i=0;i<u[n][o].length-f;i++){if(!1===e(u[n][o][i],p,v,b,w))return!1;p++}w++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===At(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Et(t){var e=[1/0,1/0,-1/0,-1/0];return At(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}function xt(t,e,r){if(!Ot(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Nt(t))throw new Error("bbox must only contain numbers")}))}(n),o&&function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function Nt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Ot(t){return!!t&&t.constructor===Object}function _t(t,e){if(!Ot(e=e||{}))throw new Error("options is invalid");var r=e.properties;if(!t)throw new Error("geojson is required");var n=Et(t);return function(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Nt(t[0])||!Nt(t[1]))throw new Error("coordinates must contain numbers");return xt({type:"Point",coordinates:t},e,r)}([(n[0]+n[2])/2,(n[1]+n[3])/2],r)}function Pt(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return St(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(r){switch(r){case"type":case"features":return;default:e[r]=t[r]}})),e.features=t.features.map((function(t){return St(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Tt(t);default:throw new Error("unknown GeoJSON type")}}function St(t){var e={type:"Feature"};return Object.keys(t).forEach((function(r){switch(r){case"type":case"properties":case"geometry":return;default:e[r]=t[r]}})),e.properties=Ct(t.properties),e.geometry=Tt(t.geometry),e}function Ct(t){var e={};return t?(Object.keys(t).forEach((function(r){var n=t[r];"object"==typeof n?null===n?e[r]=null:n.length?e[r]=n.map((function(t){return t})):e[r]=Ct(n):e[r]=n})),e):e}function Tt(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Tt(t)})),e):(e.coordinates=kt(t.coordinates),e)}function kt(t){return"object"!=typeof t[0]?t.slice():t.map((function(t){return kt(t)}))}gt.parse,gt.convertTonimn,gt.getTraversalObj,gt.convertToJson,gt.convertToJsonString,gt.validate,gt.j2xParser,gt.parseToNimn;var Ft=6371008.8,Mt={meters:Ft,metres:Ft,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:Ft/1852,inches:39.37*Ft,yards:5825721.287490856,feet:20902260.511392,radians:1,degrees:57.22891354143274};function It(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function Vt(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Dt(t,e,r){if(!(n=r=r||{})||n.constructor!==Object)throw new Error("options is invalid");var n,o=r.units,i=Vt(t),a=Vt(e),s=It(a[1]-i[1]),u=It(a[0]-i[0]),l=It(i[1]),c=It(a[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return function(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var r=Mt[e||"kilometers"];if(!r)throw new Error(e+" units is invalid");return t*r}(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),o)}function Lt(t,e,r){if(!Rt(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&zt(n),o&&Gt(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function Bt(t,e){if(!Rt(e=e||{}))throw new Error("options is invalid");var r=e.bbox,n=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&zt(r),n&&Gt(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=t,o}function qt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Rt(t){return!!t&&t.constructor===Object}function zt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!qt(t))throw new Error("bbox must only contain numbers")}))}function Gt(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Ut(t,e,r){if("object"!=typeof(r=r||{}))throw new Error("options is invalid");var n=r.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var o=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),i=function(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(e),a=e.geometry?e.geometry.type:e.type,s=e.bbox;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(o,s))return!1;"Polygon"===a&&(i=[i]);for(var u=0,l=!1;u<i.length&&!l;u++)if(Jt(o,i[u][0],n)){for(var c=!1,f=1;f<i[u].length&&!c;)Jt(o,i[u][f],!n)&&(c=!0),f++;c||(l=!0)}return l}function Jt(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,i=e.length-1;o<e.length;i=o++){var a=e[o][0],s=e[o][1],u=e[i][0],l=e[i][1];if(t[1]*(a-u)+s*(u-t[0])+l*(t[0]-a)==0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(l-t[1])<=0)return!r;s>t[1]!=l>t[1]&&t[0]<(u-a)*(t[1]-s)/(l-s)+a&&(n=!n)}return n}function $t(t){for(var e=function(t){if("FeatureCollection"!==t.type)return"Feature"!==t.type?Bt([Lt(t)]):Bt([t]);return t}(t),r=_t(e),n=!1,o=0;!n&&o<e.features.length;){var i,a=e.features[o].geometry,s=!1;if("Point"===a.type)r.geometry.coordinates[0]===a.coordinates[0]&&r.geometry.coordinates[1]===a.coordinates[1]&&(n=!0);else if("MultiPoint"===a.type){var u=!1;for(i=0;!u&&i<a.coordinates.length;)r.geometry.coordinates[0]===a.coordinates[i][0]&&r.geometry.coordinates[1]===a.coordinates[i][1]&&(n=!0,u=!0),i++}else if("LineString"===a.type)for(i=0;!s&&i<a.coordinates.length-1;)Wt(r.geometry.coordinates[0],r.geometry.coordinates[1],a.coordinates[i][0],a.coordinates[i][1],a.coordinates[i+1][0],a.coordinates[i+1][1])&&(s=!0,n=!0),i++;else if("MultiLineString"===a.type)for(var l=0;l<a.coordinates.length;){s=!1,i=0;for(var c=a.coordinates[l];!s&&i<c.length-1;)Wt(r.geometry.coordinates[0],r.geometry.coordinates[1],c[i][0],c[i][1],c[i+1][0],c[i+1][1])&&(s=!0,n=!0),i++;l++}else"Polygon"!==a.type&&"MultiPolygon"!==a.type||Ut(r,a)&&(n=!0);o++}if(n)return r;var f=Bt([]);for(o=0;o<e.features.length;o++)f.features=f.features.concat(jt(e.features[o]).features);return function(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!qt(t[0])||!qt(t[1]))throw new Error("coordinates must contain numbers");return Lt({type:"Point",coordinates:t},e,r)}(function(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var r,n=1/0;return function(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}(e,(function(e,o){var i=Dt(t,e);i<n&&((r=Pt(e)).properties.featureIndex=o,r.properties.distanceToPoint=i,n=i)})),r}(r,f).geometry.coordinates)}function Wt(t,e,r,n,o,i){return Math.sqrt((o-r)*(o-r)+(i-n)*(i-n))===Math.sqrt((t-r)*(t-r)+(e-n)*(e-n))+Math.sqrt((o-t)*(o-t)+(i-e)*(i-e))}function Zt(t,e,r){var n=r;return function(t,e){var r,n,o,i,a,s,u,l,c,f,p=0,h="FeatureCollection"===t.type,g="Feature"===t.type,d=h?t.features.length:1;for(r=0;r<d;r++){for(s=h?t.features[r].geometry:g?t.geometry:t,l=h?t.features[r].properties:g?t.properties:{},c=h?t.features[r].bbox:g?t.bbox:void 0,f=h?t.features[r].id:g?t.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,p,l,c,f))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===e(i.geometries[n],p,l,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,l,c,f))return!1;p++}}(t,(function(t,o,i,a,s){n=0===o&&void 0===r?t:e(n,t,o,i,a,s)})),n}var Xt=6378137;function Kt(t){return Zt(t,(function(t,e){return t+function(t){var e,r=0;switch(t.type){case"Polygon":return Yt(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)r+=Yt(t.coordinates[e]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function Yt(t){var e=0;if(t&&t.length>0){e+=Math.abs(Ht(t[0]));for(var r=1;r<t.length;r++)e-=Math.abs(Ht(t[r]))}return e}function Ht(t){var e,r,n,o,i,a,s=0,u=t.length;if(u>2){for(a=0;a<u;a++)a===u-2?(n=u-2,o=u-1,i=0):a===u-1?(n=u-1,o=0,i=1):(n=a,o=a+1,i=a+2),e=t[n],r=t[o],s+=(Qt(t[i][0])-Qt(e[0]))*Math.sin(Qt(r[1]));s=s*Xt*Xt/2}return s}function Qt(t){return t*Math.PI/180}function te(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n,o=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),i="Feature"===(n=e).type?n.geometry:n,a=i.type,s=e.bbox,u=i.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(o,s))return!1;"Polygon"===a&&(u=[u]);for(var l=!1,c=0;c<u.length&&!l;c++)if(ee(o,u[c][0],r.ignoreBoundary)){for(var f=!1,p=1;p<u[c].length&&!f;)ee(o,u[c][p],!r.ignoreBoundary)&&(f=!0),p++;f||(l=!0)}return l}function ee(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var o=0,i=e.length-1;o<e.length;i=o++){var a=e[o][0],s=e[o][1],u=e[i][0],l=e[i][1];if(t[1]*(a-u)+s*(u-t[0])+l*(t[0]-a)==0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(l-t[1])<=0)return!r;s>t[1]!=l>t[1]&&t[0]<(u-a)*(t[1]-s)/(l-s)+a&&(n=!n)}return n}function re(t,e){void 0===e&&(e={});var r=Number(t[0]),n=Number(t[1]),o=Number(t[2]),i=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[r,n];return function(t,e,r){void 0===r&&(r={});for(var n=0,o=t;n<o.length;n++){var i=o[n];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<i[i.length-1].length;a++)if(i[i.length-1][a]!==i[0][a])throw new Error("First and last Position are not equivalent.")}return function(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}({type:"Polygon",coordinates:t},e,r)}([[a,[o,n],[o,i],[r,i],a]],e.properties,{bbox:t,id:e.id})}var ne=function(){this.__data__=[],this.size=0};var oe=function(t,e){return t===e||t!=t&&e!=e};var ie=function(t,e){for(var r=t.length;r--;)if(oe(t[r][0],e))return r;return-1},ae=Array.prototype.splice;var se=function(t){var e=this.__data__,r=ie(e,t);return!(r<0)&&(r==e.length-1?e.pop():ae.call(e,r,1),--this.size,!0)};var ue=function(t){var e=this.__data__,r=ie(e,t);return r<0?void 0:e[r][1]};var le=function(t){return ie(this.__data__,t)>-1};var ce=function(t,e){var r=this.__data__,n=ie(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function fe(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}fe.prototype.clear=ne,fe.prototype.delete=se,fe.prototype.get=ue,fe.prototype.has=le,fe.prototype.set=ce;var pe=fe;var he=function(){this.__data__=new pe,this.size=0};var ge=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var de=function(t){return this.__data__.get(t)};var ye=function(t){return this.__data__.has(t)},ve="object"==typeof i&&i&&i.Object===Object&&i,me="object"==typeof self&&self&&self.Object===Object&&self,be=ve||me||Function("return this")(),we=be.Symbol,je=Object.prototype,Ae=je.hasOwnProperty,Ee=je.toString,xe=we?we.toStringTag:void 0;var Ne=function(t){var e=Ae.call(t,xe),r=t[xe];try{t[xe]=void 0;var n=!0}catch(t){}var o=Ee.call(t);return n&&(e?t[xe]=r:delete t[xe]),o},Oe=Object.prototype.toString;var _e=function(t){return Oe.call(t)},Pe=we?we.toStringTag:void 0;var Se=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Pe&&Pe in Object(t)?Ne(t):_e(t)};var Ce=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var Te,ke=function(t){if(!Ce(t))return!1;var e=Se(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Fe=be["__core-js_shared__"],Me=(Te=/[^.]+$/.exec(Fe&&Fe.keys&&Fe.keys.IE_PROTO||""))?"Symbol(src)_1."+Te:"";var Ie=function(t){return!!Me&&Me in t},Ve=Function.prototype.toString;var De=function(t){if(null!=t){try{return Ve.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Le=/^\[object .+?Constructor\]$/,Be=Function.prototype,qe=Object.prototype,Re=Be.toString,ze=qe.hasOwnProperty,Ge=RegExp("^"+Re.call(ze).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Ue=function(t){return!(!Ce(t)||Ie(t))&&(ke(t)?Ge:Le).test(De(t))};var Je=function(t,e){return null==t?void 0:t[e]};var $e=function(t,e){var r=Je(t,e);return Ue(r)?r:void 0},We=$e(be,"Map"),Ze=$e(Object,"create");var Xe=function(){this.__data__=Ze?Ze(null):{},this.size=0};var Ke=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ye=Object.prototype.hasOwnProperty;var He=function(t){var e=this.__data__;if(Ze){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Ye.call(e,t)?e[t]:void 0},Qe=Object.prototype.hasOwnProperty;var tr=function(t){var e=this.__data__;return Ze?void 0!==e[t]:Qe.call(e,t)};var er=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Ze&&void 0===e?"__lodash_hash_undefined__":e,this};function rr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}rr.prototype.clear=Xe,rr.prototype.delete=Ke,rr.prototype.get=He,rr.prototype.has=tr,rr.prototype.set=er;var nr=rr;var or=function(){this.size=0,this.__data__={hash:new nr,map:new(We||pe),string:new nr}};var ir=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var ar=function(t,e){var r=t.__data__;return ir(e)?r["string"==typeof e?"string":"hash"]:r.map};var sr=function(t){var e=ar(this,t).delete(t);return this.size-=e?1:0,e};var ur=function(t){return ar(this,t).get(t)};var lr=function(t){return ar(this,t).has(t)};var cr=function(t,e){var r=ar(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function fr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}fr.prototype.clear=or,fr.prototype.delete=sr,fr.prototype.get=ur,fr.prototype.has=lr,fr.prototype.set=cr;var pr=fr;var hr=function(t,e){var r=this.__data__;if(r instanceof pe){var n=r.__data__;if(!We||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new pr(n)}return r.set(t,e),this.size=r.size,this};function gr(t){var e=this.__data__=new pe(t);this.size=e.size}gr.prototype.clear=he,gr.prototype.delete=ge,gr.prototype.get=de,gr.prototype.has=ye,gr.prototype.set=hr;var dr=gr;var yr=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},vr=function(){try{var t=$e(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var mr=function(t,e,r){"__proto__"==e&&vr?vr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},br=Object.prototype.hasOwnProperty;var wr=function(t,e,r){var n=t[e];br.call(t,e)&&oe(n,r)&&(void 0!==r||e in t)||mr(t,e,r)};var jr=function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,a=e.length;++i<a;){var s=e[i],u=n?n(r[s],t[s],s,r,t):void 0;void 0===u&&(u=t[s]),o?mr(r,s,u):wr(r,s,u)}return r};var Ar=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Er=function(t){return null!=t&&"object"==typeof t};var xr=function(t){return Er(t)&&"[object Arguments]"==Se(t)},Nr=Object.prototype,Or=Nr.hasOwnProperty,_r=Nr.propertyIsEnumerable,Pr=xr(function(){return arguments}())?xr:function(t){return Er(t)&&Or.call(t,"callee")&&!_r.call(t,"callee")},Sr=Pr,Cr=Array.isArray;var Tr=function(){return!1},kr=a((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?be.Buffer:void 0,i=(o?o.isBuffer:void 0)||Tr;t.exports=i})),Fr=/^(?:0|[1-9]\d*)$/;var Mr=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Fr.test(t))&&t>-1&&t%1==0&&t<e};var Ir=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Vr={};Vr["[object Float32Array]"]=Vr["[object Float64Array]"]=Vr["[object Int8Array]"]=Vr["[object Int16Array]"]=Vr["[object Int32Array]"]=Vr["[object Uint8Array]"]=Vr["[object Uint8ClampedArray]"]=Vr["[object Uint16Array]"]=Vr["[object Uint32Array]"]=!0,Vr["[object Arguments]"]=Vr["[object Array]"]=Vr["[object ArrayBuffer]"]=Vr["[object Boolean]"]=Vr["[object DataView]"]=Vr["[object Date]"]=Vr["[object Error]"]=Vr["[object Function]"]=Vr["[object Map]"]=Vr["[object Number]"]=Vr["[object Object]"]=Vr["[object RegExp]"]=Vr["[object Set]"]=Vr["[object String]"]=Vr["[object WeakMap]"]=!1;var Dr=function(t){return Er(t)&&Ir(t.length)&&!!Vr[Se(t)]};var Lr=function(t){return function(e){return t(e)}},Br=a((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&ve.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i})),qr=Br&&Br.isTypedArray,Rr=qr?Lr(qr):Dr,zr=Object.prototype.hasOwnProperty;var Gr=function(t,e){var r=Cr(t),n=!r&&Sr(t),o=!r&&!n&&kr(t),i=!r&&!n&&!o&&Rr(t),a=r||n||o||i,s=a?Ar(t.length,String):[],u=s.length;for(var l in t)!e&&!zr.call(t,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Mr(l,u))||s.push(l);return s},Ur=Object.prototype;var Jr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ur)};var $r=function(t,e){return function(r){return t(e(r))}},Wr=$r(Object.keys,Object),Zr=Object.prototype.hasOwnProperty;var Xr=function(t){if(!Jr(t))return Wr(t);var e=[];for(var r in Object(t))Zr.call(t,r)&&"constructor"!=r&&e.push(r);return e};var Kr=function(t){return null!=t&&Ir(t.length)&&!ke(t)};var Yr=function(t){return Kr(t)?Gr(t):Xr(t)};var Hr=function(t,e){return t&&jr(e,Yr(e),t)};var Qr=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},tn=Object.prototype.hasOwnProperty;var en=function(t){if(!Ce(t))return Qr(t);var e=Jr(t),r=[];for(var n in t)("constructor"!=n||!e&&tn.call(t,n))&&r.push(n);return r};var rn=function(t){return Kr(t)?Gr(t,!0):en(t)};var nn=function(t,e){return t&&jr(e,rn(e),t)},on=a((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?be.Buffer:void 0,i=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,n=i?i(r):new t.constructor(r);return t.copy(n),n}}));var an=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var sn=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i};var un=function(){return[]},ln=Object.prototype.propertyIsEnumerable,cn=Object.getOwnPropertySymbols,fn=cn?function(t){return null==t?[]:(t=Object(t),sn(cn(t),(function(e){return ln.call(t,e)})))}:un;var pn=function(t,e){return jr(t,fn(t),e)};var hn=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},gn=$r(Object.getPrototypeOf,Object),dn=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)hn(e,fn(t)),t=gn(t);return e}:un;var yn=function(t,e){return jr(t,dn(t),e)};var vn=function(t,e,r){var n=e(t);return Cr(t)?n:hn(n,r(t))};var mn=function(t){return vn(t,Yr,fn)};var bn=function(t){return vn(t,rn,dn)},wn=$e(be,"DataView"),jn=$e(be,"Promise"),An=$e(be,"Set"),En=$e(be,"WeakMap"),xn="[object Map]",Nn="[object Promise]",On="[object Set]",_n="[object WeakMap]",Pn="[object DataView]",Sn=De(wn),Cn=De(We),Tn=De(jn),kn=De(An),Fn=De(En),Mn=Se;(wn&&Mn(new wn(new ArrayBuffer(1)))!=Pn||We&&Mn(new We)!=xn||jn&&Mn(jn.resolve())!=Nn||An&&Mn(new An)!=On||En&&Mn(new En)!=_n)&&(Mn=function(t){var e=Se(t),r="[object Object]"==e?t.constructor:void 0,n=r?De(r):"";if(n)switch(n){case Sn:return Pn;case Cn:return xn;case Tn:return Nn;case kn:return On;case Fn:return _n}return e});var In=Mn,Vn=Object.prototype.hasOwnProperty;var Dn=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Vn.call(t,"index")&&(r.index=t.index,r.input=t.input),r},Ln=be.Uint8Array;var Bn=function(t){var e=new t.constructor(t.byteLength);return new Ln(e).set(new Ln(t)),e};var qn=function(t,e){var r=e?Bn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},Rn=/\w*$/;var zn=function(t){var e=new t.constructor(t.source,Rn.exec(t));return e.lastIndex=t.lastIndex,e},Gn=we?we.prototype:void 0,Un=Gn?Gn.valueOf:void 0;var Jn=function(t){return Un?Object(Un.call(t)):{}};var $n=function(t,e){var r=e?Bn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var Wn=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return Bn(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return qn(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return $n(t,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return zn(t);case"[object Symbol]":return Jn(t)}},Zn=Object.create,Xn=function(){function t(){}return function(e){if(!Ce(e))return{};if(Zn)return Zn(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var Kn=function(t){return"function"!=typeof t.constructor||Jr(t)?{}:Xn(gn(t))};var Yn=function(t){return Er(t)&&"[object Map]"==In(t)},Hn=Br&&Br.isMap,Qn=Hn?Lr(Hn):Yn;var to=function(t){return Er(t)&&"[object Set]"==In(t)},eo=Br&&Br.isSet,ro=eo?Lr(eo):to,no="[object Arguments]",oo="[object Function]",io="[object Object]",ao={};ao[no]=ao["[object Array]"]=ao["[object ArrayBuffer]"]=ao["[object DataView]"]=ao["[object Boolean]"]=ao["[object Date]"]=ao["[object Float32Array]"]=ao["[object Float64Array]"]=ao["[object Int8Array]"]=ao["[object Int16Array]"]=ao["[object Int32Array]"]=ao["[object Map]"]=ao["[object Number]"]=ao[io]=ao["[object RegExp]"]=ao["[object Set]"]=ao["[object String]"]=ao["[object Symbol]"]=ao["[object Uint8Array]"]=ao["[object Uint8ClampedArray]"]=ao["[object Uint16Array]"]=ao["[object Uint32Array]"]=!0,ao["[object Error]"]=ao[oo]=ao["[object WeakMap]"]=!1;var so=function t(e,r,n,o,i,a){var s,u=1&r,l=2&r,c=4&r;if(n&&(s=i?n(e,o,i,a):n(e)),void 0!==s)return s;if(!Ce(e))return e;var f=Cr(e);if(f){if(s=Dn(e),!u)return an(e,s)}else{var p=In(e),h=p==oo||"[object GeneratorFunction]"==p;if(kr(e))return on(e,u);if(p==io||p==no||h&&!i){if(s=l||h?{}:Kn(e),!u)return l?yn(e,nn(s,e)):pn(e,Hr(s,e))}else{if(!ao[p])return i?e:{};s=Wn(e,p,u)}}a||(a=new dr);var g=a.get(e);if(g)return g;a.set(e,s),ro(e)?e.forEach((function(o){s.add(t(o,r,n,o,e,a))})):Qn(e)&&e.forEach((function(o,i){s.set(i,t(o,r,n,i,e,a))}));var d=f?void 0:(c?l?bn:mn:l?rn:Yr)(e);return yr(d||e,(function(o,i){d&&(o=e[i=o]),wr(s,i,t(o,r,n,i,e,a))})),s};var uo=function(t){return so(t,4)};function lo(t,e){return t>e?1:t<e?-1:0}class co{constructor(t=lo,e=!1){this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!e}rotateLeft(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e}rotateRight(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e}_splay(t){for(;t.parent;){var e=t.parent;e.parent?e.left===t&&e.parent.left===e?(this.rotateRight(e.parent),this.rotateRight(e)):e.right===t&&e.parent.right===e?(this.rotateLeft(e.parent),this.rotateLeft(e)):e.left===t&&e.parent.right===e?(this.rotateRight(e),this.rotateLeft(e)):(this.rotateLeft(e),this.rotateRight(e)):e.left===t?this.rotateRight(e):this.rotateLeft(e)}}splay(t){for(var e,r,n,o,i;t.parent;)(r=(e=t.parent).parent)&&r.parent?((n=r.parent).left===r?n.left=t:n.right=t,t.parent=n):(t.parent=null,this._root=t),o=t.left,i=t.right,t===e.left?(r&&(r.left===e?(e.right?(r.left=e.right,r.left.parent=r):r.left=null,e.right=r,r.parent=e):(o?(r.right=o,o.parent=r):r.right=null,t.left=r,r.parent=t)),i?(e.left=i,i.parent=e):e.left=null,t.right=e,e.parent=t):(r&&(r.right===e?(e.left?(r.right=e.left,r.right.parent=r):r.right=null,e.left=r,r.parent=e):(i?(r.left=i,i.parent=r):r.left=null,t.right=r,r.parent=t)),o?(e.right=o,o.parent=e):e.right=null,t.left=e,e.parent=t)}replace(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)}minNode(t=this._root){if(t)for(;t.left;)t=t.left;return t}maxNode(t=this._root){if(t)for(;t.right;)t=t.right;return t}insert(t,e){var r=this._root,n=null,o=this._compare;if(this._noDuplicates)for(;r;){if(n=r,0===o(r.key,t))return;r=o(r.key,t)<0?r.right:r.left}else for(;r;)n=r,r=o(r.key,t)<0?r.right:r.left;return r={key:t,data:e,left:null,right:null,parent:n},n?o(n.key,r.key)<0?n.right=r:n.left=r:this._root=r,this.splay(r),this._size++,r}find(t){for(var e=this._root,r=this._compare;e;){var n=r(e.key,t);if(n<0)e=e.right;else{if(!(n>0))return e;e=e.left}}return null}contains(t){for(var e=this._root,r=this._compare;e;){var n=r(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1}remove(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var r=this.minNode(e.right);r.parent!==e&&(this.replace(r,r.right),r.right=e.right,r.right.parent=r),this.replace(e,r),r.left=e.left,r.left.parent=r}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0}removeNode(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0}erase(t){var e=this.find(t);if(e){this.splay(e);var r=e.left,n=e.right,o=null;r&&(r.parent=null,o=this.maxNode(r),this.splay(o),this._root=o),n&&(r?o.right=n:this._root=n,n.parent=o),this._size--}}pop(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e}next(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e}prev(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e}forEach(t){for(var e=this._root,r=[],n=!1,o=0;!n;)e?(r.push(e),e=e.left):r.length>0?(t(e=r.pop(),o++),e=e.right):n=!0;return this}range(t,e,r,n){const o=[],i=this._compare;let a,s=this._root;for(;0!==o.length||s;)if(s)o.push(s),s=s.left;else{if(s=o.pop(),a=i(s.key,e),a>0)break;if(i(s.key,t)>=0&&r.call(n,s))return this;s=s.right}return this}keys(){for(var t=this._root,e=[],r=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),r.push(t.key),t=t.right):n=!0;return r}values(){for(var t=this._root,e=[],r=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),r.push(t.data),t=t.right):n=!0;return r}at(t){for(var e=this._root,r=[],n=!1,o=0;!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),o===t)return e;o++,e=e.right}else n=!0;return null}load(t=[],e=[],r=!1){if(0!==this._size)throw new Error("bulk-load: tree is not empty");const n=t.length;return r&&po(t,e,0,n-1,this._compare),this._root=fo(null,t,e,0,n),this._size=n,this}min(){var t=this.minNode(this._root);return t?t.key:null}max(){var t=this.maxNode(this._root);return t?t.key:null}isEmpty(){return null===this._root}get size(){return this._size}static createTree(t,e,r,n,o){return new co(r,o).load(t,e,n)}}function fo(t,e,r,n,o){const i=o-n;if(i>0){const a=n+Math.floor(i/2),s={key:e[a],data:r[a],parent:t};return s.left=fo(s,e,r,n,a),s.right=fo(s,e,r,a+1,o),s}return null}function po(t,e,r,n,o){if(r>=n)return;const i=t[r+n>>1];let a=r-1,s=n+1;for(;;){do{a++}while(o(t[a],i)<0);do{s--}while(o(t[s],i)>0);if(a>=s)break;let r=t[a];t[a]=t[s],t[s]=r,r=e[a],e[a]=e[s],e[s]=r}po(t,e,r,s,o),po(t,e,s+1,n,o)}function ho(t,e,r){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!go(e,r)||e.isVertical()?e.prevInResult:e)),t.inResult=go(t,r)}function go(t,e){switch(t.type){case 0:switch(e){case 0:return!t.otherInOut;case 1:return t.otherInOut;case 2:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case 3:return!0}break;case 2:return 0===e||1===e;case 3:return 2===e;case 1:return!1}return!1}class yo{constructor(t,e,r,n,o){this.left=e,this.point=t,this.otherEvent=r,this.isSubject=n,this.type=o||0,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0}isBelow(t){const e=this.point,r=this.otherEvent.point;return this.left?(e[0]-t[0])*(r[1]-t[1])-(r[0]-t[0])*(e[1]-t[1])>0:(r[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(r[1]-t[1])>0}isAbove(t){return!this.isBelow(t)}isVertical(){return this.point[0]===this.otherEvent.point[0]}clone(){const t=new yo(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.inResult=this.inResult,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t}}function vo(t,e){return t[0]===e[0]&&t[1]===e[1]}function mo(t,e,r){return(t[0]-r[0])*(e[1]-r[1])-(e[0]-r[0])*(t[1]-r[1])}function bo(t,e){const r=t.point,n=e.point;return r[0]>n[0]?1:r[0]<n[0]?-1:r[1]!==n[1]?r[1]>n[1]?1:-1:function(t,e,r,n){if(t.left!==e.left)return t.left?1:-1;if(0!==mo(r,t.otherEvent.point,e.otherEvent.point))return t.isBelow(e.otherEvent.point)?-1:1;return!t.isSubject&&e.isSubject?1:-1}(t,e,r)}function wo(t,e,r){const n=new yo(e,!1,t,t.isSubject),o=new yo(e,!0,t.otherEvent,t.isSubject);return vo(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),n.contourId=o.contourId=t.contourId,bo(o,t.otherEvent)>0&&(t.otherEvent.left=!0,o.left=!1),t.otherEvent.otherEvent=o,t.otherEvent=n,r.push(o),r.push(n),r}function jo(t,e){return t[0]*e[1]-t[1]*e[0]}function Ao(t,e){return t[0]*e[0]+t[1]*e[1]}function Eo(t,e,r){const n=function(t,e,r,n,o){const i=[e[0]-t[0],e[1]-t[1]],a=[n[0]-r[0],n[1]-r[1]];function s(t,e,r){return[t[0]+e*r[0],t[1]+e*r[1]]}const u=[r[0]-t[0],r[1]-t[1]];let l=jo(i,a),c=l*l;const f=Ao(i,i);if(c>0){const e=jo(u,a)/l;if(e<0||e>1)return null;const n=jo(u,i)/l;return n<0||n>1?null:0===e||1===e?o?null:[s(t,e,i)]:0===n||1===n?o?null:[s(r,n,a)]:[s(t,e,i)]}if(l=jo(u,i),c=l*l,c>0)return null;const p=Ao(i,u)/f,h=p+Ao(i,a)/f,g=Math.min(p,h),d=Math.max(p,h);return g<=1&&d>=0?1===g?o?null:[s(t,g>0?g:0,i)]:0===d?o?null:[s(t,d<1?d:1,i)]:o&&0===g&&1===d?null:[s(t,g>0?g:0,i),s(t,d<1?d:1,i)]:null}(t.point,t.otherEvent.point,e.point,e.otherEvent.point),o=n?n.length:0;if(0===o)return 0;if(1===o&&(vo(t.point,e.point)||vo(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===o&&t.isSubject===e.isSubject)return 0;if(1===o)return vo(t.point,n[0])||vo(t.otherEvent.point,n[0])||wo(t,n[0],r),vo(e.point,n[0])||vo(e.otherEvent.point,n[0])||wo(e,n[0],r),1;const i=[];let a=!1,s=!1;return vo(t.point,e.point)?a=!0:1===bo(t,e)?i.push(e,t):i.push(t,e),vo(t.otherEvent.point,e.otherEvent.point)?s=!0:1===bo(t.otherEvent,e.otherEvent)?i.push(e.otherEvent,t.otherEvent):i.push(t.otherEvent,e.otherEvent),a&&s||a?(e.type=1,t.type=e.inOut===t.inOut?2:3,a&&!s&&wo(i[1].otherEvent,i[0].point,r),2):s?(wo(i[0],i[1].point,r),3):i[0]!==i[3].otherEvent?(wo(i[0],i[1].point,r),wo(i[1],i[2].point,r),3):(wo(i[0],i[1].point,r),wo(i[3].otherEvent,i[2].point,r),3)}function xo(t,e){if(t===e)return 0;if(0!==mo(t.point,t.otherEvent.point,e.point)||0!==mo(t.point,t.otherEvent.point,e.otherEvent.point))return vo(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===bo(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;{let r=t.point,n=e.point;if(r[0]===n[0]&&r[1]===n[1])return r=t.otherEvent.point,n=e.otherEvent.point,r[0]===n[0]&&r[1]===n[1]?0:t.contourId>e.contourId?1:-1}return 1===bo(t,e)?1:-1}function No(t,e,r,n){let o,i,a=t+1;const s=e.length;for(o=e[t].point,a<s&&(i=e[a].point);a<s&&i[0]===o[0]&&i[1]===o[1];){if(!r[a])return a;a++,i=e[a].point}for(a=t-1;r[a]&&a>=n;)a--;return a}function Oo(t,e){let r,n;const o=function(t){let e,r,n,o;const i=[];for(r=0,n=t.length;r<n;r++)e=t[r],(e.left&&e.inResult||!e.left&&e.otherEvent.inResult)&&i.push(e);let a=!1;for(;!a;)for(a=!0,r=0,n=i.length;r<n;r++)r+1<n&&1===bo(i[r],i[r+1])&&(o=i[r],i[r]=i[r+1],i[r+1]=o,a=!1);for(r=0,n=i.length;r<n;r++)e=i[r],e.pos=r;for(r=0,n=i.length;r<n;r++)e=i[r],e.left||(o=e.pos,e.pos=e.otherEvent.pos,e.otherEvent.pos=o);return i}(t),i={},a=[];let s;for(r=0,n=o.length;r<n;r++){if(i[r])continue;const t=[[]];o[r].isExteriorRing?2===e&&!o[r].isSubject&&a.length>1?a[a.length-1].push(t[0]):a.push(t):2!==e||o[r].isSubject||0!==a.length?0===a.length?a.push([[t]]):a[a.length-1].push(t[0]):a.push(t);const n=a.length-1;let u=r;const l=o[r].point;for(t[0].push(l);u>=r;)s=o[u],i[u]=!0,s.left?(s.resultInOut=!1,s.contourId=n):(s.otherEvent.resultInOut=!0,s.otherEvent.contourId=n),u=s.pos,i[u]=!0,t[0].push(o[u].point),u=No(u,o,i,r);u=-1===u?r:u,s=o[u],i[u]=i[s.pos]=!0,s.otherEvent.resultInOut=!0,s.otherEvent.contourId=n}return a}var _o=So,Po=So;function So(t,e){if(!(this instanceof So))return new So(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||Co,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function Co(t,e){return t<e?-1:t>e?1:0}So.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,r=this.compare,n=e[t];t>0;){var o=t-1>>1,i=e[o];if(r(n,i)>=0)break;e[t]=i,t=o}e[t]=n},_down:function(t){for(var e=this.data,r=this.compare,n=this.length>>1,o=e[t];t<n;){var i=1+(t<<1),a=i+1,s=e[i];if(a<this.length&&r(e[a],s)<0&&(i=a,s=e[a]),r(s,o)>=0)break;e[t]=s,t=i}e[t]=o}},_o.default=Po;const To=Math.max,ko=Math.min;let Fo=0;function Mo(t,e,r,n,o,i){let a,s,u,l,c,f;for(a=0,s=t.length-1;a<s;a++){if(u=t[a],l=t[a+1],c=new yo(u,!1,void 0,e),f=new yo(l,!1,c,e),c.otherEvent=f,u[0]===l[0]&&u[1]===l[1])continue;c.contourId=f.contourId=r,i||(c.isExteriorRing=!1,f.isExteriorRing=!1),bo(c,f)>0?f.left=!0:c.left=!0;const s=u[0],p=u[1];o[0]=ko(o[0],s),o[1]=ko(o[1],p),o[2]=To(o[2],s),o[3]=To(o[3],p),n.push(c),n.push(f)}}const Io=[];function Vo(t,e,r){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);let n=function(t,e,r){let n=null;return t.length*e.length==0&&(0===r?n=Io:2===r?n=t:1!==r&&3!==r||(n=0===t.length?e:t)),n}(t,e,r);if(n)return n===Io?null:n;const o=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=function(t,e,r,n,o){const i=new _o(null,bo);let a,s,u,l,c,f;for(u=0,l=t.length;u<l;u++)for(a=t[u],c=0,f=a.length;c<f;c++)s=0===c,s&&Fo++,Mo(a[c],!0,Fo,i,r,s);for(u=0,l=e.length;u<l;u++)for(a=e[u],c=0,f=a.length;c<f;c++)s=0===c,2===o&&(s=!1),s&&Fo++,Mo(a[c],!1,Fo,i,n,s);return i}(t,e,o,i,r);if(n=function(t,e,r,n,o){let i=null;return(r[0]>n[2]||n[0]>r[2]||r[1]>n[3]||n[1]>r[3])&&(0===o?i=Io:2===o?i=t:1!==o&&3!==o||(i=t.concat(e))),i}(t,e,o,i,r),n)return n===Io?null:n;const s=function(t,e,r,n,o,i){const a=new co(xo),s=[],u=Math.min(n[2],o[2]);let l,c,f;for(;0!==t.length;){let e=t.pop();if(s.push(e),0===i&&e.point[0]>u||2===i&&e.point[0]>n[2])break;if(e.left){c=l=a.insert(e),f=a.minNode(),l=l!==f?a.prev(l):null,c=a.next(c);const r=l?l.key:null;let n;if(ho(e,r,i),c&&2===Eo(e,c.key,t)&&(ho(e,r,i),ho(e,c.key,i)),l&&2===Eo(l.key,e,t)){let t=l;t=t!==f?a.prev(t):null,n=t?t.key:null,ho(r,n,i),ho(e,r,i)}}else e=e.otherEvent,c=l=a.find(e),l&&c&&(l=l!==f?a.prev(l):null,c=a.next(c),a.remove(e),c&&l&&Eo(l.key,c.key,t))}return s}(a,0,0,o,i,r);return Oo(s,r)}var Do=function(t,e){for(var r=t[0],n=t[1],o=!1,i=0,a=e.length-1;i<e.length;a=i++){var s=e[i][0],u=e[i][1],l=e[a][0],c=e[a][1];u>n!=c>n&&r<(l-s)*(n-u)/(c-u)+s&&(o=!o)}return o},Lo=function(t){if("Point"!==t.geometry.type){switch(t.properties.way_geometry=uo(t.geometry),t.geometry.type){case"Polygon":t.properties.mesure=Kt(t.geometry);break;case"LineString":"function"==typeof length&&(t.properties.mesure=length(t))}t.geometry=$t(t.geometry).geometry}},Bo=function(t){if("no"===t.area)return!1;var e=Object.keys(t);return!(!e.includes("building")||"no"===t.building)||(!(!e.includes("landuse")||"no"===t.landuse)||(!(!e.includes("amenity")||"no"===t.amenity)||(!(!e.includes("leisure")||"no"===t.leisure)||(!(!e.includes("area")||"no"===t.area)||(!(!e.includes("place")||"no"===t.place)||(!(!e.includes("shop")||"no"===t.shop)||(!(!e.includes("boundary")||"no"===t.boundary)||(!(!e.includes("tourism")||"no"===t.tourism)||(!(!e.includes("historic")||"no"===t.historic)||(!(!e.includes("public_transport")||"no"===t.public_transport)||(!(!e.includes("office")||"no"===t.office)||(!(!e.includes("building:part")||"no"===t["building:part"])||(!(!e.includes("military")||"no"===t.military)||(!(!e.includes("ruins")||"no"===t.ruins)||(!(!e.includes("craft")||"no"===t.craft)||(!(!e.includes("golf")||"no"===t.golf)||(!(!e.includes("indoor")||"no"===t.indoor)||(!(!e.includes("highway")||!["services","rest_area","escape","elevator"].includes(t.highway))||(!(!e.includes("waterway")||!["riverbank","dock","boatyard","dam"].includes(t.waterway))||(!(!e.includes("barrier")||!["city_wall","ditch","hedge","retaining_wall","wall","spikes"].includes(t.barrier))||(!(!e.includes("railway")||!["station","turntable","roundhouse","platform"].includes(t.railway))||(!(!e.includes("power")||!["plant","substation","generator","transformer"].includes(t.power))||(!(!e.includes("natural")||["coastline","cliff","ridge","arete","tree_row"].includes(t.natural))||(!(!e.includes("man_made")||["cutline","embankment","pipeline"].includes(t.man_made))||!(!e.includes("aeroway")||["taxiway"].includes(t.aeroway))))))))))))))))))))))))))},qo=function(t,e){if(!e)return!0;if(!t)return!1;for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];if(e.includes(o))return!0}return!1},Ro=function(t,e){var r=t.properties.tags;for(var n in r)if(e.includes(n))return{k:n,v:r[n]};return null};function zo(t,e){var r,n=t.properties.tags,i={conf:void 0,matchProps:0},a=o(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=Object.keys(s.tags)[0],l=0;for(var c in s.tags)n[c]&&n[c]===s.tags[c]&&n[u]?l++:l=0;l>i.matchProps&&(i={conf:s,matchProps:l})}}catch(t){a.e(t)}finally{a.f()}if(i.conf)return i.conf;var f=t.properties.primaryTag.k?"k":"key",p=t.properties.primaryTag.k?"v":"value",h="".concat(t.properties.primaryTag[f],"/").concat(t.properties.primaryTag[p]),g={key:t.properties.primaryTag[f],icon:"wiki-question",markerColor:"#000000",lbl:{en:"".concat(t.properties.primaryTag[f]," = ").concat(t.properties.primaryTag[p])},presets:[],geometry:[],tags:{},id:h,unknowTags:!0};return g.tags[t.properties.primaryTag[f]]=t.properties.primaryTag[p],g}function Go(t){t.properties.tags.name?t.properties._name=t.properties.tags.name:t.properties.tags.ref&&(t.properties._name=t.properties.tags.ref),t.properties.meta.timestamp&&(t.properties.time=new Date(t.properties.meta.timestamp).getTime()),t.properties.tags.fixme&&(t.properties.fixme=!0)}function Uo(t,e){var r,n=zo(t,e);return r="node"===t.properties.type?"circle":"LineString"===t.properties.way_geometry.type||"MultiLineString"===t.properties.way_geometry.type?"penta":"Polygon"===t.properties.way_geometry.type||"MultiPolygon"===t.properties.way_geometry.type?"square":"star",t.properties.icon=n.icon?n.icon:"",t.properties.marker="".concat(r,"-").concat(n.markerColor,"-").concat(t.properties.icon),t.properties.hexColor=n.markerColor,t.properties.configId=n.id,n.unknowTags&&(t.properties.unknowTags=!0),n.deprecated?t.properties.deprecated=n.deprecated:t.properties.deprecated&&delete t.properties.deprecated,Go(t),t}var Jo=function(t,e){if(!e)return t;for(var r=[],n=0;n<e.features.length;n++)r.push(e.features[n].id);for(var o=t.features.length-1;o>=0;o--)r.includes(t.features[o].id)&&t.features.splice(o,1);return uo(t)},$o=function(t,e){return e&&0!==e.length?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:Vo(e.geometry.coordinates,t.geometry.coordinates,1)}}]}:{type:"FeatureCollection",features:[t]}};function Wo(t){return t.replace(/&amp;/g,"&").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}return t.addAttributesToFeature=Go,t.convert=function(t,r){var n=null;r&&r.primaryKeys&&(n=r.primaryKeys);var i=gt.parse(t,{attributeNamePrefix:"",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!1,allowBooleanAttributes:!0,parseNodeValue:!1,parseAttributeValue:!1,trimValues:!1,cdataTagName:!1,cdataPositionChar:"\\c",attrValueProcessor:function(t){return Wo(t)},tagValueProcessor:function(t){return Wo(t)}}).osm,a={minlat:Number(i.bounds.minlat),minlon:Number(i.bounds.minlon),maxlat:Number(i.bounds.maxlat),maxlon:Number(i.bounds.maxlon)},s=[a.minlon,a.minlat,a.maxlon,a.maxlat],u=function(t){Array.isArray(t)||(t=[t]);for(var e={},r=0;r<t.length;r++)e[t[r].k]=t[r].v;return e},l=function(t,e){for(var r=t[0]==t[t.length-1]?"Polygon":"LineString",n=[],o=0;o<t.length;o++){var i="node/".concat(t[o]);e[i]&&n.push(e[i].geometry.coordinates)}return"LineString"==r?{type:"LineString",coordinates:n}:"Polygon"==r?{type:"Polygon",coordinates:[n]}:void 0},c=function(t,e,r){var n=uo(t),i=Array.isArray(n.member)?n.member:[n.member];n.tainted=!1;for(var a=0;a<i.length;a++){var s=i[a],u="way/".concat(s.ref);if(e[u]){var l=e[u].geometry,c=void 0;"LineString"===l.type?(s.typeGeom="LineString",c=uo(l.coordinates)):"Polygon"===l.type&&(s.typeGeom="Polygon",c=uo(l.coordinates[0])),s.ring=c}else s.ring=null,n.tainted=!0}if(n.tainted)return null;Array.isArray(i)||(i=[i]);var p=i.filter((function(t){return"outer"===t.role&&"Polygon"===t.typeGeom&&t.ring})),h=i.filter((function(t){return"inner"===t.role&&"Polygon"===t.typeGeom&&t.ring})),g=i.filter((function(t){return"outer"===t.role&&"LineString"===t.typeGeom&&t.ring})),d=i.filter((function(t){return"inner"===t.role&&"LineString"===t.typeGeom&&t.ring}));if(0===p.length&&0===g.length)return null;if(g.length>0){var y,v=o(f(g.map((function(t){return t.ring}))));try{for(v.s();!(y=v.n()).done;){var m=y.value;p.push({type:"way",ref:"",role:"outer",typeGeom:"Polygon",ring:m})}}catch(t){v.e(t)}finally{v.f()}}if(d.length>0){var b,w=o(f(d.map((function(t){return t.ring}))));try{for(w.s();!(b=w.n()).done;){var j=b.value;h.push({type:"way",ref:"",role:"inner",typeGeom:"Polygon",ring:j})}}catch(t){w.e(t)}finally{w.f()}}if(1==p.length){var A,E=[p[0].ring],x=o(h);try{for(x.s();!(A=x.n()).done;){var N=A.value;E.push(N.ring)}}catch(t){x.e(t)}finally{x.f()}return{type:"Polygon",coordinates:E}}var O,_=p.map((function(t){return[t.ring]})),P=o(h);try{for(P.s();!(O=P.n()).done;)for(var S=O.value,C=0;C<_.length;C++){var T=_[C][0],k=S.ring[0];Do(k,T)&&_[C].push(S.ring)}}catch(t){P.e(t)}finally{P.f()}return{type:"MultiPolygon",coordinates:_}},f=function(t){var r=[],n=t[0].slice();t.splice(0,1);for(var o=n[0].toString(),i=n[n.length-1].toString(),a=0;0!=t.length&&a<t.length;)t[a][0].toString()==i?(t[a].splice(0,1),n=[].concat(e(n),e(t[a])),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):t[a][t[a].length-1].toString()==o?(t[a].splice(t[a].length-1,1),n=[].concat(e(t[a]),e(n)),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):t[a][0].toString()==o?(t[a].splice(0,1),n=[].concat(e(t[a].reverse()),e(n)),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):t[a][t[a].length-1].toString()==i?(t[a].splice(t[a].length-1,1),n=[].concat(e(n),e(t[a].reverse())),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):a++,o==i&&(r.push(n),t.length>0&&(n=t[0].slice(),t.splice(0,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0));return r},p={};Array.isArray(i.node)||(i.node=i.node?[i.node]:[]);var h,g=o(i.node);try{for(g.s();!(h=g.n()).done;){var d=h.value,y="node/".concat(d.id),v={type:"Feature",id:"node/".concat(d.id),properties:{type:"node",id:d.id,meta:{timestamp:d.timestamp,version:d.version,changeset:d.changeset,user:d.user,uid:d.uid}},geometry:{type:"Point",coordinates:[Number(d.lon),Number(d.lat)]}};d.tag&&(v.properties.tags=u(d.tag)),p[y]=v}}catch(t){g.e(t)}finally{g.f()}Array.isArray(i.way)||(i.way=i.way?[i.way]:[]);var m,b={},w=o(i.way);try{for(w.s();!(m=w.n()).done;){var j=m.value,A="way/".concat(j.id),E={type:"Feature",id:"way/".concat(j.id),properties:{type:"way",id:j.id,meta:{timestamp:j.timestamp,version:j.version,changeset:j.changeset,user:j.user,uid:j.uid}}};if(j.tag&&(E.properties.tags=u(j.tag)),j.nd){var x,N=[],O=o(j.nd);try{for(O.s();!(x=O.n()).done;){var _=x.value.ref;N.push(_);var P=p["node/".concat(_)];P&&(P.properties.usedByWays||(P.properties.usedByWays=[]),P.properties.usedByWays.push("way/".concat(j.id)))}}catch(t){O.e(t)}finally{O.f()}E.ndRefs=N,E.geometry=l(N,p)}b[A]=E}}catch(t){w.e(t)}finally{w.f()}var S={};Array.isArray(i.relation)||(i.relation=i.relation?[i.relation]:[]);var C,T=o(i.relation);try{for(T.s();!(C=T.n()).done;){var k=C.value,F="".concat(k.id),M={type:"Feature",id:"".concat(k.id),properties:{type:"relation",id:k.id,meta:{timestamp:k.timestamp,version:k.version,changeset:k.changeset,user:k.user,uid:k.uid}},member:k.member,tainted:!1};k.tag&&(M.properties.tags=u(k.tag)),Array.isArray(k.member)||(k.member=[k.member]);var I,V=o(k.member);try{for(V.s();!(I=V.n()).done;){var D=I.value,L="".concat(D.type,"/").concat(D.ref),B="node"==D.type?p:b;B[L]?(B[L].properties.relations||(B[L].properties.relations=[]),B[L].properties.relations.push({rel:M.id,reltags:M.properties.tags,role:D.role})):M.tainted=!0}}catch(t){V.e(t)}finally{V.f()}S[F]=M}}catch(t){T.e(t)}finally{T.f()}for(var q in S){var R=S[q];if("multipolygon"===R.properties.tags.type){var z=c(R,b);z&&(R.geometry=z)}}var G=function(t,e,o,i,a){var s=[];for(var u in t)if(t[u].properties.tags,t[u].geometry&&t[u].properties.tags)if(Go(t[u]),r&&i){var l=Ro(t[u],a);l&&(t[u].properties.primaryTag=l,Uo(t[u],r.tagConfig),s.push(t[u]))}else s.push(t[u]);for(var c in e)if(e[c].properties.tags,e[c].geometry&&e[c].properties.tags)if(Go(e[c]),"Polygon"!=e[c].geometry.type&&"MultiPolygon"!=e[c].geometry.type||Bo(e[c].properties.tags)||(e[c].geometry.coordinates=e[c].geometry.coordinates[0],e[c].geometry.type="Polygon"==e[c].geometry.type?"LineString":"MultiLineString"),Lo(e[c]),r&&r.tagConfig){var f=Ro(e[c],a);f&&(e[c].properties.primaryTag=f,Uo(e[c],r.tagConfig),s.push(e[c]))}else s.push(e[c]);for(var p in o){var h=o[p].properties.tags;if(o[p].geometry&&o[p].properties.tags&&qo(h,n))if(Go(o[p]),"Polygon"!=o[p].geometry.type&&"MultiPolygon"!=o[p].geometry.type||Bo(o[p].properties.tags)||(o[p].geometry.coordinates=o[p].geometry.coordinates[0],o[p].geometry.type="Polygon"==o[p].geometry.type?"LineString":"MultiLineString"),Lo(o[p]),r&&r.tagConfig){var g=Ro(o[p],a);g&&(o[p].properties.primaryTag=g,Uo(o[p],r.tagConfig),s.push(o[p]))}else s.push(o[p])}return s}(p,b,S,r.tagConfig,r.primaryKeys),U={type:"FeatureCollection",features:G};if(r&&r.oldGeojson&&r.geojsonChanged){var J=Number.isInteger(r.limitFeatures)?r.limitFeatures:9999,$=re(s);if(r.oldGeojson.features.length>J)return{geojson:Jo(U,r.geojsonChanged),geojsonBbox:$o($,null)};var W=function(t,e,r,n){var o=t.features,i=e.features;if(!o||0==o.length)return e;for(var a=[],s=0;s<o.length;s++)te(o[s],r)&&a.push(o[s].id);for(var u=0;u<i.length;u++)for(var l=i[u].id,c=0;c<o.length;c++){if(l==o[c].id){o[c]=i[u],a.splice(a.indexOf(l),1);break}c==o.length-1&&o.push(i[u])}for(var f=0;f<a.length;f++)for(var p=a[f],h=0;h<o.length;h++)if(o[h].id==p){o.splice(h,1);break}return Jo(t,n)}(r.oldGeojson,U,$,r.geojsonChanged);return{geojson:W,geojsonBbox:$o($,r.oldBboxFeature)}}return{geojson:U,geojsonBbox:null}},t.getConfigTag=zo,t.setIconStyle=Uo,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
