<div id="container" *ngIf="!loading">
    <div id="searchSelect">
        <div id="searchDiv">
            <ion-searchbar
                autocomplete="off"
                autocorrect="off"
                autocapitalize="none"
                inputmode="text"
                [(ngModel)]="searchText"
                [debounce]="300"
            ></ion-searchbar>
        </div>
    </div>

    <ion-content>
        <div class="listTag" *ngIf="searchText.length > 2 ">
            <ion-list style="overflow-y: auto">
                <ion-item
                    *ngFor="let tag of currentListOfTags
                        | filtersTagsByIds:tagsService.hiddenTagsIds:true
                        | filterDeprecatedTag 
                        | filterBySearchable 
                        | filterExcludeTagByCountryCode:countryTags 
                        | filterByByGeometryType:[geometryType]
                        | filterByTagsContent:[configService.config.languageTags, configService.config.countryTags]:searchText
                        | limitDisplayTags:50;"
                    class="ion-no-padding"
                >
                    <app-tag-list-element
                        style="width: 100%"
                        [tag]="tag"
                        [countryTags]="configService.config.countryTags"
                        [languageTags]="configService.config.languageTags"
                        [jsonSprites]="tagsService.jsonSprites"
                        [geometriesFilter]="geometriesPossible"
                        [bookmarksIds]="tagsService.bookmarksIds"
                        [oldTagConfig]="oldTagConfig"
                        (removeBookmark)="tagsService.removeBookMark(tag)"
                        (addBookmark)="tagsService.addBookMark(tag)"
                        (selected)="selected($event)"
                    >
                    </app-tag-list-element>
                </ion-item>
            </ion-list>

            <!-- Add custum value (from searchBar to the key) -->
            <div>
                <h4>{{ 'MODAL_SELECTED_ITEM.CUSTOM_KEY_VALUE' | translate}}</h4>
                <ion-chip *ngFor="let k of tagsService.primaryKeys | sortArray">
                    <ion-label
                        color="primary"
                        (click)="addCustomValue(k,searchText.toLowerCase())"
                        >{{ k }}={{searchText | lowercase}}</ion-label
                    >
                </ion-chip>
            </div>
        </div>

        <div
            class="listTag"
            *ngIf="searchText.length < 3 "
            (swipeleft)="swipeLeft()"
            (swiperight)="swipeRight()"
        >
            <p style="text-align: center; margin: 0px 0px 24px">
                {{ 'MODAL_SELECTED_ITEM.SEARCH_TAG_AT_LEAST_3_LETTERS' |
                translate}}
            </p>

            <div class="buttonsSwitchType">
                <ion-button
                    ion-button
                    (click)="changePageLastTagsBookmarks('lastTags')"
                    class="buttonSwitchType"
                    [disabled]="displayType === 'lastTags'"
                >
                    <ion-icon name="time" slot="start"></ion-icon>
                    {{'MODAL_SELECTED_ITEM.LAST_TAG_USED' | translate}}
                </ion-button>
                <ion-button
                    ion-button
                    (click)="changePageLastTagsBookmarks('bookmarks')"
                    class="buttonSwitchType"
                    [disabled]="displayType === 'bookmarks'"
                >
                    <ion-icon name="heart" slot="start"></ion-icon> {{
                    'MODAL_SELECTED_ITEM.BOOKMARKS' | translate }}
                </ion-button>
            </div>

            <div class="shadows"></div>

            <div class="lastTags tagList" *ngIf="displayType == 'lastTags'">
                <h4 style="text-align: center">
                    {{'MODAL_SELECTED_ITEM.LAST_TAG_USED' | translate}}
                </h4>

                <ion-list style="overflow-y: auto">
                    <ion-item
                        *ngFor="let tag of tagsService.tags
                      | filtersTagsByIds:tagsService.lastTagsUsedIds 
                      | filterDeprecatedTag 
                      | filterBySearchable 
                      | filterExcludeTagByCountryCode:countryTags 
                      | filterByByGeometryType:[geometryType]"
                        class="ion-no-padding"
                    >
                        <app-tag-list-element
                            style="width: 100%"
                            [tag]="tag"
                            [countryTags]="configService.config.countryTags"
                            [languageTags]="configService.config.languageTags"
                            [jsonSprites]="tagsService.jsonSprites"
                            [geometriesFilter]="geometriesPossible"
                            [bookmarksIds]="tagsService.bookmarksIds"
                            [oldTagConfig]="oldTagConfig"
                            (removeBookmark)="removeBookmark($event)"
                            (addBookmark)="addBookmark($event)"
                            (selected)="selected($event)"
                        >
                        </app-tag-list-element>
                    </ion-item>
                </ion-list>
            </div>

            <div class="bookmarks tagList" *ngIf="displayType == 'bookmarks'">
                <h4 style="text-align: center">
                    {{ 'MODAL_SELECTED_ITEM.BOOKMARKS' | translate }}
                </h4>

                <ion-list style="overflow-y: auto">
                    <ion-item
                        *ngFor="let tag of tagsService.tags 
                | filtersTagsByIds:tagsService.bookmarksIds
                | filterExcludeTagByCountryCode:countryTags 
                | filterByByGeometryType:[geometryType]"
                        class="ion-no-padding"
                    >
                        <app-tag-list-element
                            style="width: 100%"
                            [tag]="tag"
                            [countryTags]="configService.config.countryTags"
                            [languageTags]="configService.config.languageTags"
                            [jsonSprites]="tagsService.jsonSprites"
                            [geometriesFilter]="geometriesPossible"
                            [bookmarksIds]="tagsService.bookmarksIds"
                            [oldTagConfig]="oldTagConfig"
                            (removeBookmark)="removeBookmark($event)"
                            (addBookmark)="addBookmark($event)"
                            (selected)="selected($event)"
                        >
                        </app-tag-list-element>
                    </ion-item>
                </ion-list>
            </div>
        </div>
    </ion-content>

    <ion-footer>
        <div class="actions">
            <ion-button tappable (click)="dismiss()" fill="clear">
                <ion-icon name="close" slot="start"></ion-icon>
                {{ 'SHARED.CANCEL' | translate }}
            </ion-button>
        </div>
    </ion-footer>
</div>
<div *ngIf="loading" style="height: 100%">
    <!-- <ion-header>
  <ion-toolbar> -->
    <ion-title> {{ 'MODAL_SELECTED_ITEM.LOADING' | translate}} </ion-title>
    <!-- </ion-toolbar>
</ion-header> -->
</div>
